{% extends "base.html" %}

<a>{% block nav-event %}<a class="btn btn-primary active" href="{% url 'event_list' %}">Zdarzenia</a>{% endblock %}</a>

{% block title %}
<h2>Dodawanie zdarzenia</h2>
{% endblock %}

{% block content %}

<script type='text/javascript' src='https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js'></script>
<script type='text/javascript'>
$(document).ready(function(){
  $('#add_more').click(function() {
	  var form_idx = $('#id_eventproduct_set-TOTAL_FORMS').val();
	  $('#form_set').append($('#empty_form').html().replace(/__prefix__/g, form_idx));
	  $('#id_eventproduct_set-TOTAL_FORMS').val(parseInt(form_idx) + 1);
  });
});
</script>

<form action="" method="post" class = "create_event" enctype="multipart/form-data">
    {% csrf_token %}
    <p class="pt-2">
      <button type="submit" value="" class="btn btn-primary w-10 mb-3" role="button">Zapisz</button>
      <a role="button" onclick="javascript:history.back();" class="btn btn-outline-secondary w-10 mb-3">Cofnij</a>
    </p>

<table>
  <tr>
    <th>
      {{ form.as_p}}
    </th>
  </tr>
</table>

<p class="pt-2">
  <input type="button" class="btn btn-success" value="Dodaj pozycjÄ™" id="add_more">
</p>

<div class="d-inline-flex py-2">
  {{ event_formset.management_form }}
  <table class="d-inline-flex py-2">
    <tr class="d-inline-flex">
      <table>
        {% for form in event_formset.forms %}
        {% if forloop.first %}
        <thead class="">
          <tr>
            {% for field in form.visible_fields %}
              <th>
                {{ field.label|capfirst }}
              </th>
            {% endfor %}
          </tr>
        </thead>
        {% endif %}
        <div id="form_set">
          <tbody class="">
            <tr>
            {% for field in form.visible_fields %} 
              <td>
                {{ field }}
              </td>
            {% endfor %}
            </tr>
          </tbody>
        </div>
      {% endfor %}
      </table>
    </tr>
  </table>
</div>

<div id="empty_form" style="display:none">
  <tbody class="">
    <tr>
 
    {% for field in event_formset.form.visible_fields %} 
      <td>
        {{ field }}
      </td>
    {% endfor %}

    </tr>
  </tbody>
</div>
</form>
{% endblock %}